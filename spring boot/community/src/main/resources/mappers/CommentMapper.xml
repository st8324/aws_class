<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.hi.community.dao.CommentDAO">
    
    <insert id="insertComment">
    	insert into 
    	comment(co_num, co_ori_num, co_po_num, co_me_id, co_content)
    	<!-- 댓글 등록 -->
    	<if test="coDto.coOriNum == 0">
    	select 
			ifnull(max(co_num), 0) + 1,  
			ifnull(max(co_num), 0) + 1, 
		    #{coDto.postNum}, 
		    #{coDto.id}, 
		    #{coDto.content}
		from comment
		</if>
    	<!-- 
    	댓글 : co_num == co_ori_num
    	댓글이 0개 등록되어 있고, 댓글을 등록하려고 하면
    	co_num은 1, co_ori_num은 1이 되어야 함.
    	문제는 auto_increment는 기본키에만 붙일 수 있어서 co_ori_num은 못 붙임
    	
    	대댓 : co_num != co_ori_num
    	댓글이 1개 등록(1번댓글)되어 있고, 1번 댓글에 대댓을 등록하려고 하면
    	co_num은 2, co_ori_num은 1이 되어야 함
    	 -->
    </insert>
    
</mapper>





